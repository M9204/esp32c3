<!DOCTYPE html>
<html>
<head><title>ESP32 LED Control</title></head>
<body>
  <h2>LED Control</h2>
  <button id="ledBtn">Loading...</button>

  <script>
    const ws = new WebSocket(`ws://${location.hostname}:81`);
    const ledBtn = document.getElementById('ledBtn');
    let ledOn = false;

    ws.onopen = () => {
      ws.send("GET_STATE");
    };

    ws.onmessage = (event) => {
      if (event.data.startsWith("LED_STATE:")) {
        ledOn = event.data.slice(10) === "1";
        updateButton();
      }
    };

    ledBtn.onclick = () => {
      ledOn = !ledOn;
      ws.send("LED:" + (ledOn ? "1" : "0"));
      updateButton();
    };

    function updateButton() {
      ledBtn.textContent = ledOn ? "Turn LED OFF" : "Turn LED ON";
      ledBtn.style.backgroundColor = ledOn ? "green" : "gray";
      ledBtn.style.color = ledOn ? "white" : "black";
    }
  </script>
</body>
</html>
